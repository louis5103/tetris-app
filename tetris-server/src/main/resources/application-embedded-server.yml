# ===============================================================================
# Embedded Server Profile - For running inside tetris-client
# 클라이언트에 내장되어 실행될 때 사용하는 프로필
# ===============================================================================

spring:
  config:
    activate:
      on-profile: embedded-server
  
  application:
    name: Tetris Embedded Server
  
  # ===============================================================================
  # Web Application Type - SERVLET (HTTP 서버 활성화)
  # ===============================================================================
  main:
    web-application-type: servlet  # HTTP 서버 시작 (NONE이면 비활성화됨)
  
  # ===============================================================================
  # Security Configuration - DISABLE for embedded mode
  # ===============================================================================
  security:
    enabled: false
  
  # ===============================================================================
  # Database Configuration - H2 In-Memory (No external DB required)
  # CRITICAL: These settings override tetris-backend's application.properties
  # ===============================================================================
  datasource:
    url: jdbc:h2:mem:tetris-embedded;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
    driver-class-name: org.h2.Driver
    username: sa
    password: ""
    hikari:
      maximum-pool-size: 5
  
  # ===============================================================================
  # JPA Configuration - Force schema creation for embedded H2
  # ===============================================================================
  jpa:
    database-platform: org.hibernate.dialect.H2Dialect
    hibernate:
      ddl-auto: create  # 매번 스키마 생성
    show-sql: true
    properties:
      hibernate:
        format_sql: true
        show_sql: true
        hbm2ddl:
          auto: create  # 명시적으로 create 지정
    generate-ddl: true  # DDL 생성 활성화
    defer-datasource-initialization: false  # 즉시 초기화
  
  # ===============================================================================
  # SQL Initialization - DISABLE data.sql for embedded mode
  # ===============================================================================
  sql:
    init:
      mode: never  # data.sql 실행 안 함

# ===============================================================================
# Web Server Settings - Port 8090 for embedded mode
# ===============================================================================
server:
  port: 8090  # 클라이언트가 기대하는 포트
  servlet:
    context-path: /

# ===============================================================================
# Logging Configuration - INFO level to see Tomcat startup
# ===============================================================================
logging:
  level:
    root: INFO
    seoultech.se.server: INFO
    org.springframework.boot.web: INFO  # Tomcat 시작 로그 표시
    org.springframework.web: INFO
    org.hibernate: WARN
